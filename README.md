# –û—Ç—á–µ—Ç –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—É—Å–∫–∞ Stable Diffusion –¥–≤–∏–∂–∫–∞

**–î–∞—Ç–∞:** 20 –∏—é–Ω—è 2025, 05:55 (UTC+3)  
**–í–µ—Ä—Å–∏—è Replicate:** https://replicate.com/sergeishapovalov/refaopt/versions/3f028cd8332ea3560215445a894c478bcd10896b22aa8e8773c73ba0ba291901

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –¥–≤–∏–∂–∫–∞ —Å 40+ —Å–µ–∫—É–Ω–¥ –¥–æ 2-3 —Å–µ–∫—É–Ω–¥ –Ω–∞ H200 143GB GPU, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –ø–æ–ª–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

## üìä –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ —Å–æ–∫—Ä–∞—â–µ–Ω–æ —Å 40+ —Å–µ–∫—É–Ω–¥ –¥–æ 12.5 —Å–µ–∫—É–Ω–¥** (69% —É–ª—É—á—à–µ–Ω–∏–µ)
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - ADetailer, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –≤—Å–µ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–í—ã—è–≤–ª–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** –≤ –ª–æ–≥–∏–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è ADetailer

## üîß –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –º–æ–¥—É–ª–∏

### 1. **–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞** (`modules/fast_startup.py`)
```python
class FastStartup:
    def apply_all_optimizations(self):
        # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
        # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```
**–§—É–Ω–∫—Ü–∏–∏:**
- –ü–∞—Ç—á –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏ bitsandbytes
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ADetailer
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ git –ø—Ä–æ–≤–µ—Ä–æ–∫
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞

### 2. **–£–º–Ω—ã–π –ø–∞—Ç—á bitsandbytes** (`modules/smart_bitsandbytes_patch.py`)
```python
def check_bitsandbytes_installed():
    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ bitsandbytes
def patch_installation_only():
    # –ü–∞—Ç—á–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –Ω–µ —Å–∞–º –º–æ–¥—É–ª—å
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –º–æ–¥—É–ª—è –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫—É –µ—Å–ª–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è H100/H200

### 3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Extension Optimizer** (`modules/extension_optimizer_patch.py`)
```python
def patch_extension_optimizer():
    # –ü–∞—Ç—á–∏—Ç Extension Optimizer –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
def patch_extension_scripts():
    # –ü–∞—Ç—á–∏—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ë—ã—Å—Ç—Ä–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å 6+ —Å–µ–∫—É–Ω–¥ –¥–æ ~0.5 —Å–µ–∫—É–Ω–¥
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π

### 4. **–ü–∞—Ç—á –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏** (`modules/cmdargs_patch.py`)
```python
def patch_cmdargs():
    # –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
```
**–§–∏–ª—å—Ç—Ä—É–µ—Ç:**
- `--await-explicit-shutdown`
- `--upload-url`
- –î—Ä—É–≥–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã

### 5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤** (`modules/scripts_optimizer.py`)
```python
disabled_extensions = [
    "scunet_model", "swinir_model", "preprocessor_inpaint",
    "preprocessor_marigold", "preprocessor_normalbae",
    "forge_controllllite", "forge_dynamic_thresholding",
    # ... –µ—â–µ 8+ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
]
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ 14+ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤

### 6. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ç—á–∏**
- **`modules/system_patcher.py`** - –°–∏—Å—Ç–µ–º–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–º–ø–æ—Ä—Ç–æ–≤
- **`modules/pip_blocker.py`** - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ pip —É—Å—Ç–∞–Ω–æ–≤–æ–∫

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### **–ü—Ä–æ–±–ª–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è ADetailer**
**–§–∞–π–ª:** `predict.py:644-648`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - ADetailer –≤–∫–ª—é—á–∞–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
if adetailer_args.get("ad_disable") is not False:
    final_ad_args.append(face_args)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä adetailer
if adetailer and adetailer_args.get("ad_disable") is not False:
    final_ad_args.append(face_args)
```

**–ü—Ä–∏—á–∏–Ω–∞:** –õ–æ–≥–∏–∫–∞ `is not False` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –ø—Ä–∏ –ø—É—Å—Ç—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö `{}`, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –ø–∞—Ä–∞–º–µ—Ç—Ä `adetailer: false`

## üìà –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —ç—Ç–∞–ø–∞–º (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):**
```
[Timer: Imports]: 2.052 seconds
[Timer: Initialize.extension_optimizer]: 6.018 seconds  
[Timer: Initialize.imports]: 0.810 seconds
[Timer: Initialize.initialize]: 1.268 seconds
[Timer: Setup API]: 2.972 seconds
–ò–¢–û–ì–û: ~13.1 —Å–µ–∫—É–Ω–¥ (–±–µ–∑ —É—á–µ—Ç–∞ bitsandbytes —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
```

### **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –ø–æ —ç—Ç–∞–ø–∞–º (–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):**
```
[Timer: Imports]: 1.364 seconds (-0.7s)
[Timer: Initialize.extension_optimizer]: 5.632 seconds (-0.4s, –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ 0.5s)
[Timer: Initialize.imports]: 0.810 seconds (—Å—Ç–∞–±–∏–ª—å–Ω–æ)
[Timer: Initialize.initialize]: 1.330 seconds (—Å—Ç–∞–±–∏–ª—å–Ω–æ)
[Timer: Setup API]: 2.721 seconds (-0.3s)
–ò–¢–û–ì–û: ~12.5 —Å–µ–∫—É–Ω–¥
```

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ):**
- ‚úÖ **ADetailer —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
  - –î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü: `"0: 640x384 1 face, 3.4ms"`
  - –î–µ—Ç–µ–∫—Ü–∏—è —Ä—É–∫: `"0: 640x384 1 person, 15.6ms"`
  - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å–æ–∫ –∏ –∏–Ω–ø–µ–π–Ω—Ç–∏–Ω–≥
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:** 4.29 it/s (–æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ **–ü–∞–º—è—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ:** 86GB —Å–≤–æ–±–æ–¥–Ω–æ –∏–∑ 143GB
- ‚úÖ **–í—Å–µ –º–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è:** `"Not loading model, because it is cached"`

### **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:**
- **bitsandbytes –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞:** +4.1s (–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏)
- **Extension Optimizer:** +5.5s (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
- **–ù–µ–Ω—É–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:** +2.5s (–æ—Ç–∫–ª—é—á–µ–Ω—ã)
- **ADetailer –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:** +1.7s (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- **Git –ø—Ä–æ–≤–µ—Ä–∫–∏:** +0.5s (–æ—Ç–∫–ª—é—á–µ–Ω—ã)
- **–ò–¢–û–ì–û –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è:** ~14.3 —Å–µ–∫—É–Ω–¥—ã

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É

### **–†–∞–Ω–Ω–∏–µ –ø–∞—Ç—á–∏ –≤ `predict.py`:**
```python
# –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–∞—Ç—á –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ
from modules.cmdargs_patch import patch_cmdargs
patch_cmdargs()

# –ü—Ä–∏–º–µ–Ω—è–µ–º —É–º–Ω—ã–π –ø–∞—Ç—á bitsandbytes (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫—É)
from modules.smart_bitsandbytes_patch import apply_smart_patch
apply_smart_patch()

# –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–∞—Ç—á Extension Optimizer –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ
from modules.extension_optimizer_patch import apply_extension_optimizer_patch
apply_extension_optimizer_patch()
```

### **–ë—ã—Å—Ç—Ä–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ `setup()`:**
```python
def setup(self, force_download_url: str = None) -> None:
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –±—ã—Å—Ç—Ä—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ
    from modules.fast_startup import apply_fast_startup
    apply_fast_startup()
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ 2-3 —Å–µ–∫—É–Ω–¥—ã

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
1. **Extension Optimizer:** 5.6s ‚Üí 0.5s (—ç–∫–æ–Ω–æ–º–∏—è 5.1s)
2. **Setup API:** 2.7s ‚Üí 0.5s (—ç–∫–æ–Ω–æ–º–∏—è 2.2s)
3. **Initialize –º–æ–¥—É–ª–∏:** 1.3s ‚Üí 0.8s (—ç–∫–æ–Ω–æ–º–∏—è 0.5s)
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ (—ç–∫–æ–Ω–æ–º–∏—è 1-2s)

### **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: 12.5s
–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: -7.8s
–¶–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è: ~4.7s ‚Üí –¥–∞–ª—å–Ω–µ–π—à–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Üí 2-3s
```

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:**
1. **–£—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º—ã** - –ø–∞—Ç—á–∏ subprocess, os.system, –∏–º–ø–æ—Ä—Ç–æ–≤
2. **–£—Ä–æ–≤–µ–Ω—å –º–æ–¥—É–ª–µ–π** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. **–£—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –∑–∞–ø—É—Å–∫–∞
4. **–£—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- ‚úÖ –í—Å–µ –ø–∞—Ç—á–∏ –æ–±—Ä–∞—Ç–∏–º—ã
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- ‚úÖ Windows 11 (–æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)
- ‚úÖ H200 143GB GPU (—Ü–µ–ª–µ–≤–æ–µ –∂–µ–ª–µ–∑–æ)
- ‚úÖ Flux –º–æ–¥–µ–ª–∏ (–æ—Å–Ω–æ–≤–Ω–æ–π use case)
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

## üìã –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

### **–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `modules/fast_startup.py` - –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
- `modules/smart_bitsandbytes_patch.py` - –£–º–Ω—ã–π –ø–∞—Ç—á bitsandbytes
- `modules/extension_optimizer_patch.py` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Extension Optimizer
- `modules/cmdargs_patch.py` - –ü–∞—Ç—á –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- `modules/scripts_optimizer.py` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤
- `modules/system_patcher.py` - –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ç—á–∏
- `modules/pip_blocker.py` - –ë–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫ pip —É—Å—Ç–∞–Ω–æ–≤–æ–∫

### **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `predict.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ADetailer –ª–æ–≥–∏–∫–∏

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∞ **–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è:

1. **–°–æ–∫—Ä–∞—Ç–∏–ª–∞ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –≤ 3+ —Ä–∞–∑–∞** (—Å 40s –¥–æ 12.5s)
2. **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. **–ò—Å–ø—Ä–∞–≤–∏–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–∫–ª—é—á–µ–Ω–∏–µ–º ADetailer
4. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç** –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤—ã—Ö 2-3 —Å–µ–∫—É–Ω–¥
5. **–û–±–µ—Å–ø–µ—á–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–º —É–ª—É—á—à–µ–Ω–∏—è–º.

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏—Å—Ç–µ–º–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏*  
*–í–µ—Ä—Å–∏—è Replicate: https://replicate.com/sergeishapovalov/refaopt/versions/3f028cd8332ea3560215445a894c478bcd10896b22aa8e8773c73ba0ba291901*
